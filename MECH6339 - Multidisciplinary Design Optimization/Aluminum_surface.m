% Matthew Zaksek
% MECH 6339 (Multidisciplinary Design Optimization)
% Project 3
% Surface Equation Fitting
% May 11, 2022

clc;
close all;
clear all;

% Internal pressure (Pa)
Pi = [0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07];

% Wall thickness (m)
t = [0.03375; 0.03375; 0.03375; 0.03375; 0.03375; 0.03375; 0.03375; 0.045; 0.045; 0.045; 0.045; 0.045; 0.045; 0.045; 0.06; 0.06; 0.06; 0.06; 0.06; 0.06; 0.06; 0.08; 0.08; 0.08; 0.08; 0.08; 0.08; 0.08; 0.1; 0.1; 0.1; 0.1; 0.1; 0.1; 0.1; 0.125; 0.125; 0.125; 0.125; 0.125; 0.125; 0.125; 0.15625; 0.15625; 0.15625; 0.15625; 0.15625; 0.15625; 0.15625];

% Maximum von Mises stresses (Pa)
S_max = [0; 27470000; 54940000; 82390000; 109800000; 1.37E+08; 164700000; 0; 23110000; 46220000; 69320000; 92420000; 115500000; 138600000; 0; 20010000; 40010000; 60000000; 80000000; 99980000; 120000000; 0; 18920000; 37840000; 56750000; 75660000; 94560000; 113500000; 0; 16310000; 32610000; 48910000; 65210000; 81500000; 97780000; 0; 15140000; 30270000; 45410000; 60530000; 75650000; 90770000; 0; 14280000; 28550000; 42820000; 57090000; 71350000; 85610000];

% Curve fitting function
f = fit([Pi t],S_max,"poly23")

figure;
plot(f,[Pi t],S_max);
title('Surface Fitting: Aluminum 6061')
xlabel('Internal Pressure (Pa)')
ylabel('Wall Thickness (m)')
zlabel('Maximum Stress (Pa)')
% hold on;
% % Plot optimal solution, in red
% plot3(31026000,0.191175601390327,5.514966193118024e+07,'.r')