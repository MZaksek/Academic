% Matthew Zaksek
% MECH 6339 (Multidisciplinary Design Optimization)
% Project 3
% Surface Equation Fitting
% May 11, 2022

clc;
close all;
clear all;

% Internal pressure (Pa)
Pi = [0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07; 0.00E+00; 6.89E+06; 1.38E+07; 2.07E+07; 2.76E+07; 3.45E+07; 4.14E+07];

% Wall thickness (m)
t = [0.003796875; 0.003796875; 0.003796875; 0.003796875; 0.003796875; 0.003796875; 0.003796875; 0.0050625; 0.0050625; 0.0050625; 0.0050625; 0.0050625; 0.0050625; 0.0050625; 0.00675; 0.00675; 0.00675; 0.00675; 0.00675; 0.00675; 0.00675; 0.009; 0.009; 0.009; 0.009; 0.009; 0.009; 0.009; 0.01125; 0.01125; 0.01125; 0.01125; 0.01125; 0.01125; 0.01125; 0.0140625; 0.0140625; 0.0140625; 0.0140625; 0.0140625; 0.0140625; 0.0140625; 0.017578125; 0.017578125; 0.017578125; 0.017578125; 0.017578125; 0.017578125; 0.017578125];

% Maximum von Mises stresses (Pa)
S_max = [0; 171600000; 343100000; 514400000; 685600000; 8.57E+08; 1027000000; 0; 130700000; 261300000; 391800000; 522300000; 652800000; 783200000; 0; 100300000; 200500000; 300700000; 400800000; 500900000; 601000000; 0; 77240000; 154500000; 231700000; 308800000; 386000000; 463100000; 0; 63540000; 127100000; 190600000; 254100000; 317600000; 381100000; 0; 52470000; 104900000; 157400000; 209800000; 262300000; 314700000; 0; 43960000; 87920000; 131900000; 175800000; 219800000; 263700000];

% Curve fitting function
f = fit([Pi t],S_max,"poly23")

figure;
plot(f,[Pi t],S_max);
title('Surface Fitting: AISI 4130 Steel, Normalized at 870Â°C')
xlabel('Internal Pressure (Pa)')
ylabel('Wall Thickness (m)')
zlabel('Maximum Stress (Pa)')
% hold on;
% % Plot optimal solution, in red
% plot3(31026000,0.006876471527007,4.5814e+08,'.r')